# =============================================================================
# STOCK BACKTEST CONFIGURATION (Phase 3)
# =============================================================================
# Backtesting configuration for US equities.
# Uses historical stock data from Alpaca/Polygon.
# =============================================================================

mode: backtest
run_id: stock-backtest
logs_dir: logs/stocks/backtest
artifacts_dir: artifacts/stocks/backtest

# ASSET CLASS
asset_class: equity
data_vendor: alpaca  # or polygon

# Model to evaluate
model_path: "models/stocks/best_model.zip"

# =============================================================================
# DATA CONFIGURATION
# =============================================================================
data:
  timeframe: "4h"
  asset_class: equity

  source: local  # or alpaca, polygon

  paths:
    - "data/stocks/*.parquet"
    - "data/stocks/*.feather"

  # Backtest window
  start_ts: 1735689600    # 2025-01-01
  end_ts: 1759276800      # 2025-10-01

  # Stock-specific
  filter_trading_hours: true
  include_extended_hours: false

# =============================================================================
# EXECUTION SIMULATION
# =============================================================================
execution:
  enabled: true
  mode: bar
  profile: MKT_OPEN_NEXT_4H

execution_config:
  notional_threshold: 10000.0
  large_order_algo: TWAP
  pov:
    participation: 0.10
    child_interval_s: 60
    min_child_notional: 20.0

# =============================================================================
# ENVIRONMENT
# =============================================================================
env:
  decision_timing: CLOSE_TO_OPEN
  initial_cash: 100000.0
  max_position: 1.0

  session:
    calendar: us_equity
    extended_hours: false

  no_trade:
    enabled: true
    enforce_trading_hours: true

# =============================================================================
# FEES (STOCK-SPECIFIC)
# =============================================================================
fees:
  structure: flat
  maker_bps: 0.0
  taker_bps: 0.0

  regulatory:
    enabled: true
    sec_fee_per_million: 27.80
    taf_fee_per_share: 0.000166
    taf_fee_cap: 8.30

# =============================================================================
# RISK
# =============================================================================
risk:
  max_position: 1.0
  max_drawdown: 0.20

# =============================================================================
# OUTPUT
# =============================================================================
output:
  save_trades: true
  save_equity_curve: true
  save_metrics: true
  metrics_path: "artifacts/stocks/backtest/metrics.json"
  trades_path: "artifacts/stocks/backtest/trades.csv"
  equity_path: "artifacts/stocks/backtest/equity_curve.csv"
