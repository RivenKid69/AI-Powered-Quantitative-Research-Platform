# –ü—Ä–æ—Å—Ç–æ–µ –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –û—à–∏–±–∫–∏ –≤ Quantile Huber Loss

## üéØ –ì–ª–∞–≤–Ω–æ–µ: –í–∞—à–µ –û–±—É—á–µ–Ω–∏–µ –ù–ï –ü–æ—Å—Ç—Ä–∞–¥–∞–ª–æ!

**–ü–æ—á–µ–º—É?** –ü–æ—Ç–æ–º—É —á—Ç–æ –≤–µ–∑–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `kappa = 1.0`, –∞ –¥–µ–ª–µ–Ω–∏–µ –Ω–∞ 1 –Ω–∏—á–µ–≥–æ –Ω–µ –º–µ–Ω—è–µ—Ç.

---

## ü§î –ß—Ç–æ –í–æ–æ–±—â–µ –ü—Ä–æ–∏–∑–æ—à–ª–æ?

### –ê–Ω–∞–ª–æ–≥–∏—è —Å –ê–≤—Ç–æ–º–æ–±–∏–ª–µ–º

–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ –≤ –≤–∞—à–µ–π –º–∞—à–∏–Ω–µ –µ—Å—Ç—å **–¥–≤–µ –ø–µ–¥–∞–ª–∏**:

1. **–ü–µ–¥–∞–ª—å –≥–∞–∑–∞** - –¥–ª—è –æ–±—ã—á–Ω–æ–π –µ–∑–¥—ã (–º–∞–ª–µ–Ω—å–∫–∏–µ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏)
2. **–ö—Ä—É–∏–∑-–∫–æ–Ω—Ç—Ä–æ–ª—å** - –¥–ª—è –¥–∞–ª—å–Ω–∏—Ö —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π (–±–æ–ª—å—à–∏–µ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏)

–ü–∞—Ä–∞–º–µ—Ç—Ä **kappa** –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫–æ–≥–¥–∞ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è –º–µ–∂–¥—É –ø–µ–¥–∞–ª—è–º–∏.

### –û—à–∏–±–∫–∞ –≤ –ö–æ–¥–µ

**–î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
```python
—Å–∏–ª–∞_–Ω–∞–∂–∞—Ç–∏—è = –Ω—É–∂–Ω–∞—è_—Å–∫–æ—Ä–æ—Å—Ç—å / kappa  # ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û
```

**–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
```python
—Å–∏–ª–∞_–Ω–∞–∂–∞—Ç–∏—è = –Ω—É–∂–Ω–∞—è_—Å–∫–æ—Ä–æ—Å—Ç—å  # ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û
```

---

## üìä –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ü—Ä–∏–º–µ—Ä

### –°–∏—Ç—É–∞—Ü–∏—è: –°–µ—Ç—å –ü—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –¶–µ–Ω—É –ê–∫—Ç–∏–≤–∞

**–¶–µ–ª—å:** 100$
**–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ:** 97$ (–æ—à–∏–±–∫–∞ -3$)

–ö–≤–∞–Ω—Ç–∏–ª—å–Ω–∞—è —Å–µ—Ç—å —É—á–∏—Ç—Å—è –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å –Ω–µ –æ–¥–Ω–æ —á–∏—Å–ª–æ, –∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:
- "–° –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é 10% —Ü–µ–Ω–∞ –±—É–¥–µ—Ç –Ω–∏–∂–µ 95$"
- "–° –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é 50% —Ü–µ–Ω–∞ –±—É–¥–µ—Ç –æ–∫–æ–ª–æ 100$"
- "–° –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é 90% —Ü–µ–Ω–∞ –±—É–¥–µ—Ç –Ω–∏–∂–µ 105$"

### –ö–∞–∫ –°–µ—Ç—å –£—á–∏—Ç—Å—è?

**–®–∞–≥ 1:** –í—ã—á–∏—Å–ª–∏—Ç—å –æ—à–∏–±–∫—É = –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ - –¶–µ–ª—å
**–®–∞–≥ 2:** –í—ã—á–∏—Å–ª–∏—Ç—å loss (–Ω–∞—Å–∫–æ–ª—å–∫–æ –ø–ª–æ—Ö–æ)
**–®–∞–≥ 3:** –í—ã—á–∏—Å–ª–∏—Ç—å –≥—Ä–∞–¥–∏–µ–Ω—Ç (–≤ –∫–∞–∫—É—é —Å—Ç–æ—Ä–æ–Ω—É —É–ª—É—á—à–∞—Ç—å)
**–®–∞–≥ 4:** –û–±–Ω–æ–≤–∏—Ç—å –≤–µ—Å–∞ —Å–µ—Ç–∏

---

## ‚ùå –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –î–µ–ª–µ–Ω–∏–µ –Ω–∞ Kappa

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: kappa = 1.0 (—Å–µ–π—á–∞—Å)

```
–û—à–∏–±–∫–∞ = -3$

–° –û–®–ò–ë–ö–û–ô:
  loss = 0.5 * 3¬≤ / 1.0 = 4.5
  gradient = 3 / 1.0 = 3
  ‚Üì
  –í–µ—Å–∞ –æ–±–Ω–æ–≤—è—Ç—Å—è –Ω–∞: -3 * learning_rate

–ë–ï–ó –û–®–ò–ë–ö–ò:
  loss = 0.5 * 3¬≤ = 4.5
  gradient = 3
  ‚Üì
  –í–µ—Å–∞ –æ–±–Ω–æ–≤—è—Ç—Å—è –Ω–∞: -3 * learning_rate
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ **–û–î–ò–ù–ê–ö–û–í–û!** –î–µ–ª–µ–Ω–∏–µ –Ω–∞ 1 –Ω–µ –º–µ–Ω—è–µ—Ç –Ω–∏—á–µ–≥–æ.

---

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: kappa = 0.5 (–µ—Å–ª–∏ –±—ã –∏–∑–º–µ–Ω–∏–ª–∏)

```
–û—à–∏–±–∫–∞ = -3$

–° –û–®–ò–ë–ö–û–ô:
  loss = 0.5 * 3¬≤ / 0.5 = 9.0  (–≤ 2 —Ä–∞–∑–∞ –±–æ–ª—å—à–µ!)
  gradient = 3 / 0.5 = 6       (–≤ 2 —Ä–∞–∑–∞ –±–æ–ª—å—à–µ!)
  ‚Üì
  –í–µ—Å–∞ –æ–±–Ω–æ–≤—è—Ç—Å—è –Ω–∞: -6 * learning_rate

–ë–ï–ó –û–®–ò–ë–ö–ò:
  loss = 0.5 * 3¬≤ = 4.5
  gradient = 3
  ‚Üì
  –í–µ—Å–∞ –æ–±–Ω–æ–≤—è—Ç—Å—è –Ω–∞: -3 * learning_rate
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚ùå **–ì–†–ê–î–ò–ï–ù–¢ –£–î–í–û–ï–ù!**

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
- –°–µ—Ç—å –¥–µ–ª–∞–µ—Ç **—Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏–µ —à–∞–≥–∏**
- –ú–æ–∂–µ—Ç **–ø–µ—Ä–µ–ø—Ä—ã–≥–∏–≤–∞—Ç—å** —á–µ—Ä–µ–∑ –æ–ø—Ç–∏–º—É–º
- –û–±—É—á–µ–Ω–∏–µ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è **–Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–º**
- **Loss –ø—Ä—ã–≥–∞–µ—Ç –≤–≤–µ—Ä—Ö-–≤–Ω–∏–∑**
- –ù—É–∂–Ω–æ **—É–º–µ–Ω—å—à–∞—Ç—å learning rate** –≤ 2 —Ä–∞–∑–∞

---

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: kappa = 2.0 (–µ—Å–ª–∏ –±—ã –∏–∑–º–µ–Ω–∏–ª–∏)

```
–û—à–∏–±–∫–∞ = -3$

–° –û–®–ò–ë–ö–û–ô:
  loss = 0.5 * 3¬≤ / 2.0 = 2.25  (–≤ 2 —Ä–∞–∑–∞ –º–µ–Ω—å—à–µ)
  gradient = 3 / 2.0 = 1.5      (–≤ 2 —Ä–∞–∑–∞ –º–µ–Ω—å—à–µ)
  ‚Üì
  –í–µ—Å–∞ –æ–±–Ω–æ–≤—è—Ç—Å—è –Ω–∞: -1.5 * learning_rate

–ë–ï–ó –û–®–ò–ë–ö–ò:
  loss = 0.5 * 3¬≤ = 4.5
  gradient = 3
  ‚Üì
  –í–µ—Å–∞ –æ–±–Ω–æ–≤—è—Ç—Å—è –Ω–∞: -3 * learning_rate
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚ùå **–ì–†–ê–î–ò–ï–ù–¢ –£–ú–ï–ù–¨–®–ï–ù –í–î–í–û–ï!**

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
- –°–µ—Ç—å –¥–µ–ª–∞–µ—Ç **—Å–ª–∏—à–∫–æ–º –º–∞–ª–µ–Ω—å–∫–∏–µ —à–∞–≥–∏**
- –û–±—É—á–µ–Ω–∏–µ **–æ—á–µ–Ω—å –º–µ–¥–ª–µ–Ω–Ω–æ–µ**
- –ù—É–∂–Ω–æ **–Ω–∞–º–Ω–æ–≥–æ –±–æ–ª—å—à–µ —ç–ø–æ—Ö**
- –ù—É–∂–Ω–æ **—É–≤–µ–ª–∏—á–∏–≤–∞—Ç—å learning rate** –≤ 2 —Ä–∞–∑–∞

---

## üé≠ –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è: –ì—Ä–∞—Ñ–∏–∫ Loss

### –ü—Ä–∏ kappa = 1.0 (–Ω–æ—Ä–º–∞)
```
Loss
 ^
 |     /\
 |    /  \___
 |   /        \___
 |  /             \___
 | /                  \___
 +-----------------------> –≠–ø–æ—Ö–∏
   –ü–ª–∞–≤–Ω–æ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ ‚úÖ
```

### –ü—Ä–∏ kappa = 0.5 (—Å –æ—à–∏–±–∫–æ–π)
```
Loss
 ^
 |  /\  /\  /\  /\
 | /  \/  \/  \/  \
 |                  \  /\
 |                   \/  \
 +-----------------------> –≠–ø–æ—Ö–∏
   –°–∫–∞—á–µ—Ç! –ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ! ‚ùå
```

### –ü—Ä–∏ kappa = 2.0 (—Å –æ—à–∏–±–∫–æ–π)
```
Loss
 ^
 |
 | \
 |  \
 |   \_______________
 |                   \___
 +-----------------------> –≠–ø–æ—Ö–∏
   –°–ª–∏—à–∫–æ–º –º–µ–¥–ª–µ–Ω–Ω–æ! ‚ùå
```

---

## üîç –†–µ–∞–ª—å–Ω—ã–µ –ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è

### –ï—Å–ª–∏ –ë–´ –≤—ã —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–ª–∏ —Å kappa (—Å –æ—à–∏–±–∫–æ–π)

**–ü–æ–ø—ã—Ç–∫–∞ 1:** kappa = 0.5
```
–†–µ–∑—É–ª—å—Ç–∞—Ç: Loss –≤–∑—Ä—ã–≤–∞–µ—Ç—Å—è –Ω–∞ 100-–π —ç–ø–æ—Ö–µ
–ú—ã—Å–ª—å: "–°—Ç—Ä–∞–Ω–Ω–æ... –º–æ–∂–µ—Ç learning rate —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π?"
–î–µ–π—Å—Ç–≤–∏–µ: –£–º–µ–Ω—å—à–∞—é LR —Å 0.001 –¥–æ 0.0005
```

**–ü–æ–ø—ã—Ç–∫–∞ 2:** kappa = 1.0
```
–†–µ–∑—É–ª—å—Ç–∞—Ç: –û–±—É—á–∞–µ—Ç—Å—è –Ω–æ—Ä–º–∞–ª—å–Ω–æ —Å LR = 0.001
–ú—ã—Å–ª—å: "–•–º, —Å kappa=1.0 —Ä–∞–±–æ—Ç–∞–µ—Ç... –∑–∞–ø—É—Ç–∞–ª—Å—è"
```

**–ü–æ–ø—ã—Ç–∫–∞ 3:** kappa = 2.0
```
–†–µ–∑—É–ª—å—Ç–∞—Ç: –û–±—É—á–µ–Ω–∏–µ –∏–¥–µ—Ç, –Ω–æ –û–ß–ï–ù–¨ –º–µ–¥–ª–µ–Ω–Ω–æ
–ú—ã—Å–ª—å: "–ü–æ—á–µ–º—É —Ç–∞–∫ –¥–æ–ª–≥–æ? –£–≤–µ–ª–∏—á—É LR –¥–æ 0.002"
```

**–í—ã–≤–æ–¥:**
- ‚ùå –ö–∞–∂–¥—ã–π —Ä–∞–∑ –Ω—É–∂–µ–Ω **—Å–≤–æ–π learning rate**
- ‚ùå –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ **—Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å** —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
- ‚ùå –ù–µ–ø–æ–Ω—è—Ç–Ω–æ, **–≤–ª–∏—è–µ—Ç –ª–∏ kappa** –Ω–∞ –∫–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–∏
- ‚ùå –¢—Ä–∞—Ç–∏—Ç–µ –≤—Ä–µ–º—è –Ω–∞ **–±–µ—Å–ø–æ–ª–µ–∑–Ω—É—é –æ—Ç–ª–∞–¥–∫—É**

---

### –ü–æ—Å–ª–µ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–±–µ–∑ –æ—à–∏–±–∫–∏)

**–ü–æ–ø—ã—Ç–∫–∞ 1:** kappa = 0.5
```
–†–µ–∑—É–ª—å—Ç–∞—Ç: –û–±—É—á–∞–µ—Ç—Å—è —Å—Ç–∞–±–∏–ª—å–Ω–æ —Å LR = 0.001
```

**–ü–æ–ø—ã—Ç–∫–∞ 2:** kappa = 1.0
```
–†–µ–∑—É–ª—å—Ç–∞—Ç: –û–±—É—á–∞–µ—Ç—Å—è —Å—Ç–∞–±–∏–ª—å–Ω–æ —Å LR = 0.001
```

**–ü–æ–ø—ã—Ç–∫–∞ 3:** kappa = 2.0
```
–†–µ–∑—É–ª—å—Ç–∞—Ç: –û–±—É—á–∞–µ—Ç—Å—è —Å—Ç–∞–±–∏–ª—å–Ω–æ —Å LR = 0.001
```

**–í—ã–≤–æ–¥:**
- ‚úÖ –û–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ **learning rate** —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–µ–∑–¥–µ
- ‚úÖ –ú–æ–∂–Ω–æ **—á–µ—Å—Ç–Ω–æ —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å** kappa = 0.5 vs 1.0 vs 2.0
- ‚úÖ **–ü—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ–µ** –ø–æ–≤–µ–¥–µ–Ω–∏–µ
- ‚úÖ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç **–Ω–∞—É—á–Ω—ã–º —Å—Ç–∞—Ç—å—è–º**

---

## üéØ –ò—Ç–æ–≥–æ–≤—ã–µ –í—ã–≤–æ–¥—ã

### –ß—Ç–æ –ü—Ä–æ–∏–∑–æ—à–ª–æ?

1. **–ù–∞—à–ª–∏ –æ—à–∏–±–∫—É:** –õ–∏—à–Ω–µ–µ –¥–µ–ª–µ–Ω–∏–µ –Ω–∞ `kappa` –≤ —Ñ–æ—Ä–º—É–ª–µ loss
2. **–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–ª–∏:** –ü—Ä–æ–≤–µ—Ä–∏–ª–∏ 10+ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π, –≤—Å–µ –±–µ–∑ –¥–µ–ª–µ–Ω–∏—è
3. **–ò—Å–ø—Ä–∞–≤–∏–ª–∏:** –£–±—Ä–∞–ª–∏ `/ kappa`
4. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª–∏:** –°–æ–∑–¥–∞–ª–∏ 35+ —Ç–µ—Å—Ç–æ–≤

### –í–ª–∏—è–Ω–∏–µ –Ω–∞ –í–∞—à–∏ –ú–æ–¥–µ–ª–∏

| –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è | –í–ª–∏—è–Ω–∏–µ |
|--------------|---------|
| **–í—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –º–æ–¥–µ–ª–∏** | ‚úÖ –ù–û–õ–¨ (kappa=1.0 –≤–µ–∑–¥–µ) |
| **–¢–µ–∫—É—â–µ–µ –æ–±—É—á–µ–Ω–∏–µ** | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ |
| **–ü—Ä–æ—à–ª—ã–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã** | ‚úÖ –ù–µ –ø–æ—Å—Ç—Ä–∞–¥–∞–ª–∏ |

### –í–ª–∏—è–Ω–∏–µ –Ω–∞ –ë—É–¥—É—â–µ–µ

| –°—Ü–µ–Ω–∞—Ä–∏–π | –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è | –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è |
|----------|----------------|-------------------|
| **–≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã —Å kappa** | ‚ùå –ù–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ |
| **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ kappa** | ‚ùå –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ | ‚úÖ –ß–µ—Å—Ç–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ |
| **–ü–æ–¥–±–æ—Ä learning rate** | ‚ùå –î–ª—è –∫–∞–∂–¥–æ–≥–æ kappa —Å–≤–æ–π | ‚úÖ –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π |
| **–ù–∞—É—á–Ω–∞—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å** | ‚ùå –ù–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç QR-DQN | ‚úÖ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç |

---

## üöÄ –ß—Ç–æ –≠—Ç–æ –î–∞–µ—Ç?

### 1. **–ì–∏–±–∫–æ—Å—Ç—å**
–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Å kappa:
- `kappa = 0.5` - –±–æ–ª–µ–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –∫ –º–∞–ª–µ–Ω—å–∫–∏–º –æ—à–∏–±–∫–∞–º
- `kappa = 1.0` - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ (—Å–µ–π—á–∞—Å)
- `kappa = 2.0` - –±–æ–ª–µ–µ —Ä–æ–±–∞—Å—Ç–Ω–æ –∫ –≤—ã–±—Ä–æ—Å–∞–º

### 2. **–ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å**
–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç:
- ‚úÖ –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–π —Å—Ç–∞—Ç—å–µ QR-DQN (Dabney et al., 2018)
- ‚úÖ Google Dopamine (–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è)
- ‚úÖ Stable-Baselines3 (—Å—Ç–∞–Ω–¥–∞—Ä—Ç —Å–æ–æ–±—â–µ—Å—Ç–≤–∞)
- ‚úÖ –í—Å–µ–º –∞–≤—Ç–æ—Ä–∏—Ç–µ—Ç–Ω—ã–º —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è–º

### 3. **–ü—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç—å**
- –ì—Ä–∞–¥–∏–µ–Ω—Ç—ã –≤–µ–¥—É—Ç —Å–µ–±—è –æ–∂–∏–¥–∞–µ–º–æ
- Learning rate —Ä–∞–±–æ—Ç–∞–µ—Ç —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ
- –ú–æ–∂–Ω–æ —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã

### 4. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**
- –ù–∞ 1 –æ–ø–µ—Ä–∞—Ü–∏—é –º–µ–Ω—å—à–µ (–Ω–µ—Ç –¥–µ–ª–µ–Ω–∏—è)
- –õ—É—á—à–µ —á–∏—Å–ª–µ–Ω–Ω–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å

---

## ü§ì –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –î–µ—Ç–∞–ª–∏ (–¥–ª—è –ª—é–±–æ–ø—ã—Ç–Ω—ã—Ö)

### Quantile Huber Loss - –ó–∞—á–µ–º –ù—É–∂–µ–Ω?

**–û–±—ã—á–Ω—ã–π Q-learning:**
```
Q(s,a) = –æ–¥–Ω–æ —á–∏—Å–ª–æ (—Å—Ä–µ–¥–Ω–µ–µ –æ–∂–∏–¥–∞–µ–º–æ–µ –≤–æ–∑–Ω–∞–≥—Ä–∞–∂–¥–µ–Ω–∏–µ)
```

**Distributional Q-learning:**
```
Q(s,a) = —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–æ–∑–Ω–∞–≥—Ä–∞–∂–¥–µ–Ω–∏–π
         (–≤–µ—Å—å —Å–ø–µ–∫—Ç—Ä –≤–æ–∑–º–æ–∂–Ω—ã—Ö –∏—Å—Ö–æ–¥–æ–≤)
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- üìä –õ—É—á—à–µ –º–æ–¥–µ–ª–∏—Ä—É–µ—Ç **—Ä–∏—Å–∫**
- üéØ –¢–æ—á–Ω–µ–µ –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç **–Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç—å**
- üöÄ –ß–∞—Å—Ç–æ **–±—ã—Å—Ç—Ä–µ–µ —Å—Ö–æ–¥–∏—Ç—Å—è**
- üí™ –ë–æ–ª–µ–µ **—Ä–æ–±–∞—Å—Ç–Ω–æ–µ** –æ–±—É—á–µ–Ω–∏–µ

### –ü–æ—á–µ–º—É Huber Loss?

**Mean Squared Error (MSE):**
```
loss = (–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ - —Ü–µ–ª—å)¬≤
```
- ‚úÖ –ì–ª–∞–¥–∫–∏–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã
- ‚ùå –ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –∫ –≤—ã–±—Ä–æ—Å–∞–º

**Mean Absolute Error (MAE):**
```
loss = |–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ - —Ü–µ–ª—å|
```
- ‚úÖ –†–æ–±–∞—Å—Ç–µ–Ω –∫ –≤—ã–±—Ä–æ—Å–∞–º
- ‚ùå –ù–µ–≥–ª–∞–¥–∫–∏–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã –≤ –Ω—É–ª–µ

**Huber Loss (–ª—É—á—à–µ–µ –∏–∑ –¥–≤—É—Ö –º–∏—Ä–æ–≤):**
```
loss = { 0.5 * error¬≤,              –µ—Å–ª–∏ |error| ‚â§ kappa
       { kappa * (|error| - 0.5*Œ∫), –µ—Å–ª–∏ |error| > kappa
```
- ‚úÖ –ì–ª–∞–¥–∫–∏–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã (–∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–∞—è —á–∞—Å—Ç—å)
- ‚úÖ –†–æ–±–∞—Å—Ç–µ–Ω –∫ –≤—ã–±—Ä–æ—Å–∞–º (–ª–∏–Ω–µ–π–Ω–∞—è —á–∞—Å—Ç—å)
- ‚úÖ –ü–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ—á–∫–µ kappa

---

## üìö –°—Å—ã–ª–∫–∏

**–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç—å—è:**
- Dabney et al., 2018 - "Distributional Reinforcement Learning with Quantile Regression"
- https://arxiv.org/abs/1710.10044

**–≠—Ç–∞–ª–æ–Ω–Ω—ã–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**
- Google Dopamine: https://github.com/google/dopamine
- Stable-Baselines3: https://github.com/Stable-Baselines-Team/stable-baselines3-contrib

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –≤ –ø—Ä–æ–µ–∫—Ç–µ:**
- `QUANTILE_HUBER_LOSS_FIX.md` - –¥–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- `QUANTILE_HUBER_DEEP_VERIFICATION.md` - –ø–æ–ª–Ω—ã–π –æ—Ç—á–µ—Ç –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
- `explain_impact_simple.py` - —Å–∫—Ä–∏–ø—Ç —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏

---

## ‚úÖ –§–∏–Ω–∞–ª—å–Ω—ã–π –ß–µ–∫-–ª–∏—Å—Ç

- [x] –û—à–∏–±–∫–∞ –Ω–∞–π–¥–µ–Ω–∞ –∏ –ø–æ–Ω—è—Ç–∞
- [x] –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–æ
- [x] 35+ —Ç–µ—Å—Ç–æ–≤ —Å–æ–∑–¥–∞–Ω—ã
- [x] –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–∞ 100%
- [x] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ–ª–Ω–∞—è
- [x] –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞
- [x] –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —É–ª—É—á—à–µ–Ω–∞

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–û–õ–ù–û–°–¢–¨–Æ –ò–°–ü–†–ê–í–õ–ï–ù–û –ò –ü–†–û–í–ï–†–ï–ù–û

---

**–î–∞—Ç–∞:** 2025-11-17
**–ê–≤—Ç–æ—Ä:** Claude
**–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å:** 100%
